---
# tasks file for lazyvim
- name: Install neovim & dependencies
  become: true
  ansible.builtin.package:
    name:
      - neovim
      - luarocks
      - fd-find

- name: Install neovim package from pnpm
  community.general.pnpm:
    name: neovim
    global: true

- name: Install tree-sitter package from pnpm
  community.general.pnpm:
    name: tree-sitter-cli
    global: true

- name: Install Lazyvim dependencies
  become: true
  ansible.builtin.package:
    name:
      - fzf
      - luarocks

- name: Install Lazyvim dependencies on RedHat Based OS
  become: true
  when: ansible_os_family == 'RedHat'
  ansible.builtin.dnf:
    name:
      - python3-neovim
      - gcc-c++  # Required by nvim-treesitter

- name: Install Lazyvim
  ansible.builtin.git:
    repo: https://github.com/LazyVim/starter.git
    dest: "{{ ansible_user_dir }}/config/nvim"
    depth: 1
    update: false
    version: main
